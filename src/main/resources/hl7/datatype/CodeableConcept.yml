#
# (C) Copyright IBM Corp. 2020, 2021
#
# SPDX-License-Identifier: Apache-2.0
#
# Represents codeable concept that can be derived from CE/CNE/CWE

coding_1:
# coding requires code,display and system defined as variables from the resource that calls this resource
   valueOf: datatype/Coding
   generateList: true
   expressionType: resource
   condition: $code NOT_NULL &&  $coding NULL
   specs: CE |CNE
   vars:
      code: CE.1 |CNE.1
      system: CE.3 |CNE.3
      version: CE.6 |CNE.7

coding_2:
   condition: $code NOT_NULL && $coding NULL
   type: CODING_SYSTEM_V2
   valueOf: ID |IS |TX
   generateList: true
   expressionType: HL7Spec
   vars:
      code: ID |IS |TX

# Generalized CWE for alternate codes handles mismatched systems and codes       
coding_3:
   valueOf: $coding
   generateList: true
   condition: $coding NOT_NULL
   specs: CWE
   vars:
      coding: CODING_SYSTEM_V2_ALTERNATE, CWE          
      
# Generalized CWE through CODING_SYSTEM_V2 handles mismatched systems and codes      
coding_4:
   valueOf: $coding
   generateList: true
   condition: $coding NOT_NULL
   specs: CWE
   vars:
      coding: CODING_SYSTEM_V2, CWE      

coding_5:
   valueOf: $coding
   condition: $coding NOT_NULL
   generateList: true
   
# If hideText is not passed by parent, the value is NULL, making it backward compatible with all other uses of CodeableConcept
# Any value in hideText will cause the text to be hidden.  Used by Identifier_SystemID. 
text:
   condition: $hideText NULL && $displayText NOT_NULL
   type: STRING
   valueOf: $displayText
   vars:
      displayText: $text | CWE.2 | CWE.9 | CE.2 | CNE.2| ST | TX | ID | IS | CWE.5
